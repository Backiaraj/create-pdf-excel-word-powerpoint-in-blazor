@page "/excel"
@using ServerSideApplication.Data
@inject ExcelService service
@inject Microsoft.JSInterop.IJSRuntime JS
@using System.IO;

<h2>Syncfusion Excel library (Essential XlsIO)</h2>

<p>Syncfusion Excel library (Essential XlsIO)  is a Blazor Excel library used to create, read, edit, and convert Excel files in your applications without Microsoft Office dependencies.</p>

<button class="btn btn-primary" onclick="@CreateExcel">Create Excel</button>

@functions {
    MemoryStream excelStream;

    /// <summary>
    /// Create and download the Excel document
    /// </summary>
    protected async void CreateExcel()
    {
        excelStream = service.CreateExcel();
        await JS.SaveAs("Sample.xlsx", excelStream.ToArray());
    }
}